<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Educational Credentials Generator</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: Arial, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
        }

        .header {
            text-align: center;
            color: white;
            margin-bottom: 30px;
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
        }

        .warning {
            background: #ff4444;
            color: white;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
            font-weight: bold;
            text-align: center;
        }

        .main-content {
            display: grid;
            grid-template-columns: 350px 1fr;
            gap: 30px;
        }

        .controls {
            background: white;
            padding: 30px;
            border-radius: 12px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
            height: fit-content;
        }

        .controls h2 {
            margin-bottom: 20px;
            color: #333;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #555;
        }

        .form-group input,
        .form-group select {
            width: 100%;
            padding: 10px;
            border: 2px solid #ddd;
            border-radius: 6px;
            font-size: 14px;
        }

        .form-group input:focus,
        .form-group select:focus {
            outline: none;
            border-color: #667eea;
        }

        .btn {
            width: 100%;
            padding: 12px;
            background: #667eea;
            color: white;
            border: none;
            border-radius: 6px;
            font-size: 16px;
            cursor: pointer;
            transition: background 0.3s;
            margin-bottom: 10px;
        }

        .btn:hover {
            background: #5568d3;
        }

        .btn:disabled {
            background: #ccc;
            cursor: not-allowed;
        }

        .progress {
            margin-top: 15px;
            padding: 10px;
            background: #f3f4f6;
            border-radius: 6px;
            display: none;
        }

        .progress.active {
            display: block;
        }

        .progress-text {
            color: #333;
            font-size: 14px;
            margin-bottom: 8px;
        }

        .progress-bar {
            width: 100%;
            height: 20px;
            background: #e5e7eb;
            border-radius: 10px;
            overflow: hidden;
        }

        .progress-bar-fill {
            height: 100%;
            background: #667eea;
            transition: width 0.3s;
        }

        .preview-container {
            background: white;
            padding: 40px;
            border-radius: 12px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
            overflow: auto;
        }

        /* Diploma Styles */
        .credential {
            width: 100%;
            background: white;
            position: relative;
        }

        .diploma {
            aspect-ratio: 1.414 / 1;
            padding: 60px;
            display: flex;
            flex-direction: column;
            justify-content: space-between;
        }

        .diploma.classic {
            background: linear-gradient(135deg, #fef3c7 0%, #fde68a 100%);
            border: 12px double #78350f;
            font-family: Georgia, serif;
            color: #78350f;
        }

        .diploma.modern {
            background: linear-gradient(135deg, #f1f5f9 0%, #e0e7ff 100%);
            border: 6px solid #334155;
            font-family: Arial, sans-serif;
            color: #1e293b;
        }

        .diploma.elegant {
            background: linear-gradient(135deg, #faf5ff 0%, #e0e7ff 100%);
            border: 12px double #581c87;
            font-family: Georgia, serif;
            color: #581c87;
        }

        .credential-watermark {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%) rotate(-45deg);
            font-size: 100px;
            font-weight: bold;
            opacity: 0.1;
            pointer-events: none;
            z-index: 1;
        }

        .diploma-header {
            text-align: center;
            position: relative;
            z-index: 2;
        }

        .diploma-header .subtitle {
            font-size: 14px;
            letter-spacing: 3px;
            text-transform: uppercase;
            opacity: 0.7;
            margin-bottom: 10px;
        }

        .diploma-header h2 {
            font-size: 36px;
            margin-bottom: 15px;
        }

        .diploma-header .line {
            width: 150px;
            height: 3px;
            background: currentColor;
            opacity: 0.3;
            margin: 0 auto;
        }

        .diploma-body {
            text-align: center;
            position: relative;
            z-index: 2;
        }

        .diploma-body p {
            margin: 15px 0;
        }

        .diploma-body .certify {
            font-size: 18px;
        }

        .diploma-body .student-name {
            font-size: 48px;
            font-weight: bold;
            font-style: italic;
            margin: 20px 0;
        }

        .diploma-body .degree {
            font-size: 28px;
            font-weight: 600;
            margin: 15px 0;
        }

        .diploma-body .major {
            font-size: 28px;
            font-weight: 600;
        }

        .diploma-body .honors {
            font-size: 18px;
            font-style: italic;
            margin-top: 15px;
        }

        .diploma-footer {
            display: flex;
            justify-content: space-between;
            align-items: flex-end;
            position: relative;
            z-index: 2;
        }

        .signature {
            text-align: center;
        }

        .signature .line {
            width: 180px;
            height: 2px;
            background: currentColor;
            margin-bottom: 5px;
        }

        .signature .title {
            font-size: 14px;
        }

        .date-section {
            text-align: center;
        }

        .date-section .date {
            font-size: 20px;
            margin-bottom: 8px;
        }

        .date-section .label {
            font-size: 12px;
            text-transform: uppercase;
            letter-spacing: 1px;
            opacity: 0.7;
        }

        /* TOR Styles */
        .tor {
            font-family: Arial, sans-serif;
            color: #333;
            background: white;
            font-size: 11px;
        }

        .tor-page {
            padding: 30px 40px;
            min-height: 1320px;
            page-break-after: always;
            position: relative;
        }

        .tor-page:last-child {
            page-break-after: auto;
        }

        .tor-header {
            text-align: center;
            margin-bottom: 20px;
            border-bottom: 3px solid #333;
            padding-bottom: 15px;
        }

        .tor-header h1 {
            font-size: 22px;
            margin-bottom: 5px;
        }

        .tor-header h2 {
            font-size: 16px;
            color: #666;
            margin-bottom: 10px;
        }

        .tor-header .doc-title {
            font-size: 18px;
            font-weight: bold;
            text-transform: uppercase;
            letter-spacing: 2px;
        }

        .tor-info {
            margin-bottom: 20px;
            font-size: 11px;
        }

        .tor-info-row {
            display: flex;
            margin-bottom: 5px;
        }

        .tor-info-label {
            font-weight: bold;
            width: 130px;
        }

        .tor-table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 20px;
            font-size: 10px;
        }

        .tor-table th,
        .tor-table td {
            border: 1px solid #333;
            padding: 4px 6px;
            text-align: left;
        }

        .tor-table th {
            background: #f3f4f6;
            font-weight: bold;
            font-size: 10px;
        }

        .tor-table .text-center {
            text-align: center;
        }

        .tor-table .semester-row td {
            background: #e5e7eb;
            font-weight: bold;
            border: 1px solid #333;
        }

        .tor-summary {
            margin-top: 15px;
            padding: 12px;
            background: #f9fafb;
            border: 2px solid #333;
            font-size: 11px;
        }

        .tor-summary-row {
            display: flex;
            justify-content: space-between;
            margin-bottom: 6px;
        }

        .tor-summary-row.total {
            font-weight: bold;
            font-size: 13px;
            border-top: 2px solid #333;
            padding-top: 8px;
            margin-top: 8px;
        }

        .tor-footer {
            margin-top: 30px;
            display: flex;
            justify-content: space-between;
            font-size: 11px;
        }

        .tor-signature {
            text-align: center;
        }

        .tor-signature .sig-line {
            width: 200px;
            border-top: 2px solid #333;
            margin-bottom: 5px;
        }

        /* Certificate Styles */
        .certificate {
            aspect-ratio: 1.414 / 1;
            padding: 50px;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
            background: linear-gradient(135deg, #f0f9ff 0%, #e0f2fe 100%);
            border: 15px solid #0284c7;
            font-family: Georgia, serif;
            color: #0c4a6e;
        }

        .certificate-seal {
            width: 80px;
            height: 80px;
            border: 4px solid #0284c7;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            margin-bottom: 20px;
            font-size: 12px;
        }

        .certificate h1 {
            font-size: 48px;
            margin-bottom: 30px;
            text-transform: uppercase;
            letter-spacing: 3px;
        }

        .certificate .institution-name {
            font-size: 28px;
            font-weight: bold;
            margin-bottom: 40px;
        }

        .certificate .body-text {
            font-size: 18px;
            margin-bottom: 15px;
            max-width: 600px;
        }

        .certificate .student-name {
            font-size: 42px;
            font-weight: bold;
            margin: 30px 0;
        }

        .certificate .program-info {
            font-size: 22px;
            font-weight: 600;
            margin: 20px 0;
        }

        .certificate-footer {
            margin-top: 50px;
            display: flex;
            gap: 100px;
            justify-content: center;
        }

        .sample-notice {
            text-align: center;
            color: #ff4444;
            font-weight: bold;
            margin-top: 20px;
            font-size: 14px;
        }

        @media (max-width: 1024px) {
            .main-content {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>Educational Credentials Generator</h1>
        </div>

        <div class="warning">
            ‚ö†Ô∏è FOR DEMONSTRATION PURPOSES ONLY - NOT VALID FOR OFFICIAL USE
        </div>

        <div class="main-content">
            <div class="controls">
                <h2>Generate Credentials</h2>
                
                <div class="form-group">
                    <label for="credType">Credential Type</label>
                    <select id="credType">
                        <option value="diploma">Diploma</option>
                        <option value="tor">Transcript of Records (TOR)</option>
                        <option value="certificate">Certificate of Graduation</option>
                    </select>
                </div>

                <div class="form-group" id="styleGroup">
                    <label for="style">Style</label>
                    <select id="style">
                        <option value="classic">Classic Traditional</option>
                        <option value="modern">Modern Minimal</option>
                        <option value="elegant">Elegant Royal</option>
                    </select>
                </div>

                <div class="form-group">
                    <label for="degree">Degree</label>
                    <select id="degree">
                        <option>Bachelor of Science</option>
                        <option>Bachelor of Arts</option>
                        <option>Master of Science</option>
                        <option>Master of Arts</option>
                        <option>Doctor of Philosophy</option>
                    </select>
                </div>

                <div class="form-group">
                    <label for="major">Major</label>
                    <input type="text" id="major" value="Computer Science">
                </div>

                <div class="form-group">
                    <label for="institution">Institution</label>
                    <input type="text" id="institution" value="Sample University">
                </div>

                <div class="form-group">
                    <label for="count">Number to Generate</label>
                    <input type="number" id="count" value="1" min="1" max="50">
                </div>

                <button class="btn" id="generateBtn" onclick="generateCredentials()">üì• Generate & Download PDFs</button>

                <div class="progress" id="progress">
                    <div class="progress-text" id="progressText">Generating 0 of 0...</div>
                    <div class="progress-bar">
                        <div class="progress-bar-fill" id="progressFill"></div>
                    </div>
                </div>
            </div>

            <div class="preview-container">
                <div id="credentialPreview"></div>
                <div class="sample-notice">
                    ‚ö†Ô∏è SAMPLE DOCUMENT - NOT VALID FOR OFFICIAL USE
                </div>
            </div>
        </div>
    </div>

    <script>
        // Random data generators
        const firstNames = [
            'James', 'Mary', 'John', 'Patricia', 'Robert', 'Jennifer', 'Michael', 'Linda',
            'William', 'Elizabeth', 'David', 'Barbara', 'Richard', 'Susan', 'Joseph', 'Jessica',
            'Thomas', 'Sarah', 'Charles', 'Karen', 'Christopher', 'Nancy', 'Daniel', 'Lisa',
            'Matthew', 'Betty', 'Anthony', 'Margaret', 'Mark', 'Sandra', 'Donald', 'Ashley',
            'Steven', 'Kimberly', 'Paul', 'Emily', 'Andrew', 'Donna', 'Joshua', 'Michelle'
        ];

        const middleNames = [
            'Alexander', 'Anne', 'Benjamin', 'Catherine', 'Christopher', 'Elizabeth', 'Daniel', 'Grace',
            'Edward', 'Helen', 'Francis', 'Isabel', 'George', 'Jane', 'Henry', 'Katherine',
            'Isaac', 'Louise', 'Jacob', 'Marie', 'James', 'Nicole', 'Joseph', 'Olivia',
            'Lee', 'Patricia', 'Michael', 'Rose', 'Nicholas', 'Sophia', 'Oliver', 'Victoria'
        ];

        const lastNames = [
            'Smith', 'Johnson', 'Williams', 'Brown', 'Jones', 'Garcia', 'Miller', 'Davis',
            'Rodriguez', 'Martinez', 'Hernandez', 'Lopez', 'Gonzalez', 'Wilson', 'Anderson', 'Thomas',
            'Taylor', 'Moore', 'Jackson', 'Martin', 'Lee', 'Thompson', 'White', 'Harris',
            'Sanchez', 'Clark', 'Ramirez', 'Lewis', 'Robinson', 'Walker', 'Young', 'Allen',
            'King', 'Wright', 'Scott', 'Torres', 'Nguyen', 'Hill', 'Flores', 'Green'
        ];

        const courses = [
            'Data Structures', 'Algorithms', 'Database Systems', 'Web Development',
            'Operating Systems', 'Computer Networks', 'Software Engineering', 'Calculus I',
            'Calculus II', 'Linear Algebra', 'Statistics', 'Physics I', 'Physics II',
            'English Composition', 'Technical Writing', 'Ethics', 'Philosophy',
            'Artificial Intelligence', 'Machine Learning', 'Computer Graphics'
        ];

        const honors = ['Summa Cum Laude', 'Magna Cum Laude', 'Cum Laude', ''];

        function getRandomElement(array) {
            return array[Math.floor(Math.random() * array.length)];
        }

        function generateRandomName() {
            return `${getRandomElement(firstNames)} ${getRandomElement(middleNames)} ${getRandomElement(lastNames)}`;
        }

        function generateRandomDate() {
            const months = ['January', 'February', 'March', 'April', 'May', 'June', 
                          'July', 'August', 'September', 'October', 'November', 'December'];
            const year = 2020 + Math.floor(Math.random() * 5);
            const month = getRandomElement(months);
            const day = 1 + Math.floor(Math.random() * 28);
            return `${month} ${day}, ${year}`;
        }

        function generateGrade() {
            const grades = ['1.00', '1.25', '1.50', '1.75', '2.00', '2.25', '2.50', '2.75', '3.00'];
            return getRandomElement(grades);
        }

        function generateStudentID() {
            return '2020-' + Math.floor(Math.random() * 90000 + 10000);
        }

        // Get form elements
        const credTypeSelect = document.getElementById('credType');
        const styleSelect = document.getElementById('style');
        const styleGroup = document.getElementById('styleGroup');
        const degreeSelect = document.getElementById('degree');
        const majorInput = document.getElementById('major');
        const institutionInput = document.getElementById('institution');
        const countInput = document.getElementById('count');
        const generateBtn = document.getElementById('generateBtn');
        const progress = document.getElementById('progress');
        const progressText = document.getElementById('progressText');
        const progressFill = document.getElementById('progressFill');
        const credentialPreview = document.getElementById('credentialPreview');

        // Template generators
        function generateDiplomaHTML(studentName, date, honor, style) {
            return `
                <div class="credential diploma ${style}">
                    <div class="credential-watermark">SAMPLE</div>
                    <div class="diploma-header">
                        <div class="subtitle">Diploma</div>
                        <h2>${institutionInput.value}</h2>
                        <div class="line"></div>
                    </div>
                    <div class="diploma-body">
                        <p class="certify">This is to certify that</p>
                        <p class="student-name">${studentName}</p>
                        <p class="certify">has fulfilled all requirements for the degree of</p>
                        <p class="degree">${degreeSelect.value}</p>
                        <p class="certify">in</p>
                        <p class="major">${majorInput.value}</p>
                        ${honor ? `<p class="honors">${honor}</p>` : ''}
                    </div>
                    <div class="diploma-footer">
                        <div class="signature">
                            <div class="line"></div>
                            <div class="title">President</div>
                        </div>
                        <div class="date-section">
                            <div class="date">${date}</div>
                            <div class="label">Date Conferred</div>
                        </div>
                        <div class="signature">
                            <div class="line"></div>
                            <div class="title">Dean</div>
                        </div>
                    </div>
                </div>
            `;
        }

        function generateTORHTML(studentName, studentID, date) {
            const coursesPool = {
                'FIN': ['Basic Business Finance', 'Investment Analysis and Portfolio Management', 'Financial Management I', 
                        'Financial Management II', 'Bank Management', 'International Finance and Global Banking',
                        'Credit Management and Collection Policies', 'Treasury Management', 'Financial Plan',
                        'Practicum and Seminar in Finance'],
                'ENG': ['World Literature', 'Technical Writing', 'Business Communication'],
                'BMA': ['Business Statistics', 'Business Research', 'Business Policy'],
                'LAW': ['Obligations and Contracts', 'Negotiable Instruments'],
                'TAX': ['Income Taxation', 'Business and Transfer Taxes'],
                'MAN': ['Management of Non-Bank Financial Institutions', 'Trust Management', 'Risk Management and Insurance'],
                'ETHICS': ['Character Education and Professional Ethics'],
                'SOC': ['Logic and Scientific Methods'],
                'FNM': ['Financial Management II'],
                'GEN': ['Mathematics', 'Philosophy', 'History', 'Physical Education', 'Art Appreciation']
            };

            let allCourses = [];
            let courseCounter = {
                'FIN': 102, 'ENG': 22, 'BMA': 53, 'LAW': 51, 'TAX': 51,
                'MAN': 103, 'ETHICS': 22, 'SOC': 22, 'FNM': 52, 'GEN': 101
            };

            // Generate 4 years, 2 semesters each
            for (let year = 1; year <= 4; year++) {
                for (let sem = 1; sem <= 2; sem++) {
                    const startYear = 2010 + year - 1;
                    const endYear = startYear + (sem === 1 ? 0 : 1);
                    
                    allCourses.push({
                        type: 'semester',
                        label: `${sem === 1 ? '1st' : '2nd'} Semester, ${startYear}-${endYear}`,
                        courses: []
                    });

                    // Add 6-8 courses per semester
                    const coursesInSem = 6 + Math.floor(Math.random() * 3);
                    for (let i = 0; i < coursesInSem; i++) {
                        const depts = Object.keys(coursesPool);
                        const dept = getRandomElement(depts);
                        const courseName = getRandomElement(coursesPool[dept]);
                        const courseCode = `${dept} ${courseCounter[dept]++}`;
                        
                        allCourses[allCourses.length - 1].courses.push({
                            code: courseCode,
                            name: courseName,
                            units: Math.random() > 0.3 ? 3 : 2,
                            grade: generateGrade()
                        });
                    }
                }
                
                // Add summer if not final year
                if (year < 4) {
                    allCourses.push({
                        type: 'semester',
                        label: `Summer, ${2010 + year}`,
                        courses: []
                    });
                    
                    // 2-3 courses in summer
                    const summerCourses = 2 + Math.floor(Math.random() * 2);
                    for (let i = 0; i < summerCourses; i++) {
                        const depts = Object.keys(coursesPool);
                        const dept = getRandomElement(depts);
                        const courseName = getRandomElement(coursesPool[dept]);
                        const courseCode = `${dept} ${courseCounter[dept]++}`;
                        
                        allCourses[allCourses.length - 1].courses.push({
                            code: courseCode,
                            name: courseName,
                            units: 3,
                            grade: generateGrade()
                        });
                    }
                }
            }

            let totalUnits = 0;
            let totalGradePoints = 0;
            let totalCourses = 0;

            // Split into two pages
            const midPoint = Math.ceil(allCourses.length / 2);
            const page1Semesters = allCourses.slice(0, midPoint);
            const page2Semesters = allCourses.slice(midPoint);

            function generateSemesterRows(semesters) {
                let rows = '';
                semesters.forEach(semester => {
                    rows += `
                        <tr class="semester-row">
                            <td colspan="4" style="font-weight: bold; background: #e5e7eb; padding: 6px 8px;">
                                ${semester.label}
                            </td>
                        </tr>
                    `;
                    
                    semester.courses.forEach(course => {
                        rows += `
                            <tr>
                                <td>${course.code}</td>
                                <td>${course.name}</td>
                                <td class="text-center">${course.units}</td>
                                <td class="text-center">${course.grade}</td>
                            </tr>
                        `;
                        totalUnits += course.units;
                        totalGradePoints += parseFloat(course.grade) * course.units;
                        totalCourses++;
                    });
                });
                return rows;
            }

            const page1Rows = generateSemesterRows(page1Semesters);
            const page2Rows = generateSemesterRows(page2Semesters);
            const gwa = (totalGradePoints / totalUnits).toFixed(2);

            return `
                <div class="credential tor">
                    <div class="credential-watermark">SAMPLE</div>
                    
                    <div class="tor-page">
                        <div class="tor-header">
                            <h1>${institutionInput.value}</h1>
                            <h2>Office of the Registrar</h2>
                            <div class="doc-title">Transcript of Records</div>
                        </div>
                        <div class="tor-info">
                            <div class="tor-info-row">
                                <div class="tor-info-label">Student Name:</div>
                                <div>${studentName}</div>
                            </div>
                            <div class="tor-info-row">
                                <div class="tor-info-label">Student ID:</div>
                                <div>${studentID}</div>
                            </div>
                            <div class="tor-info-row">
                                <div class="tor-info-label">Program:</div>
                                <div>${degreeSelect.value} in ${majorInput.value}</div>
                            </div>
                            <div class="tor-info-row">
                                <div class="tor-info-label">Date Issued:</div>
                                <div>${date}</div>
                            </div>
                        </div>
                        <table class="tor-table">
                            <thead>
                                <tr>
                                    <th style="width: 120px;">Course No.</th>
                                    <th>Descriptive Title</th>
                                    <th class="text-center" style="width: 100px;">Units of Credit</th>
                                    <th class="text-center" style="width: 100px;">Final Grade</th>
                                </tr>
                            </thead>
                            <tbody>
                                ${page1Rows}
                            </tbody>
                        </table>
                    </div>

                    <div class="tor-page">
                        <div class="tor-header">
                            <h1>${institutionInput.value}</h1>
                            <h2>Office of the Registrar</h2>
                            <div class="doc-title">Transcript of Records (Page 2)</div>
                        </div>
                        <div class="tor-info" style="margin-bottom: 15px;">
                            <div class="tor-info-row">
                                <div class="tor-info-label">Student Name:</div>
                                <div>${studentName}</div>
                            </div>
                            <div class="tor-info-row">
                                <div class="tor-info-label">Student ID:</div>
                                <div>${studentID}</div>
                            </div>
                        </div>
                        <table class="tor-table">
                            <thead>
                                <tr>
                                    <th style="width: 120px;">Course No.</th>
                                    <th>Descriptive Title</th>
                                    <th class="text-center" style="width: 100px;">Units of Credit</th>
                                    <th class="text-center" style="width: 100px;">Final Grade</th>
                                </tr>
                            </thead>
                            <tbody>
                                ${page2Rows}
                            </tbody>
                        </table>
                        
                        <div style="margin-top: 15px; padding: 8px; border-top: 2px solid #333; font-size: 10px;">
                            <p style="margin-bottom: 8px;">Graduated with the degree of <strong>${degreeSelect.value}</strong>, major in <strong>${majorInput.value}</strong> and
                            <strong>TREASURY MANAGEMENT</strong> on March 25, 2012 as approved by the Pamantasan University Council and by virtue of Resolution
                            No. 3454 of the Board of Regents, dated March 20, 2012.</p>
                        </div>

                        <div class="tor-summary">
                            <div class="tor-summary-row">
                                <span>Total Units Earned:</span>
                                <span>${totalUnits}</span>
                            </div>
                            <div class="tor-summary-row">
                                <span>Total Courses Completed:</span>
                                <span>${totalCourses}</span>
                            </div>
                            <div class="tor-summary-row total">
                                <span>General Weighted Average (GWA):</span>
                                <span>${gwa}</span>
                            </div>
                        </div>
                        <div class="tor-footer">
                            <div class="tor-signature">
                                <div class="sig-line"></div>
                                <div>University Registrar</div>
                            </div>
                            <div class="tor-signature">
                                <div class="sig-line"></div>
                                <div>Date: ${date}</div>
                            </div>
                        </div>
                    </div>
                </div>
            `;
        }

        function generateCertificateHTML(studentName, date) {
            return `
                <div class="credential certificate">
                    <div class="credential-watermark">SAMPLE</div>
                    <div class="certificate-seal">
                        <div>OFFICIAL<br>SEAL</div>
                    </div>
                    <h1>Certificate of Graduation</h1>
                    <div class="institution-name">${institutionInput.value}</div>
                    <div class="body-text">
                        This is to certify that
                    </div>
                    <div class="student-name">${studentName}</div>
                    <div class="body-text">
                        has successfully completed all requirements for graduation and<br>
                        has been awarded the degree of
                    </div>
                    <div class="program-info">
                        ${degreeSelect.value}<br>
                        in ${majorInput.value}
                    </div>
                    <div class="body-text">
                        Conferred on ${date}
                    </div>
                    <div class="certificate-footer">
                        <div class="signature">
                            <div class="sig-line"></div>
                            <div>University President</div>
                        </div>
                        <div class="signature">
                            <div class="sig-line"></div>
                            <div>Dean</div>
                        </div>
                    </div>
                </div>
            `;
        }

        function updatePreview() {
            const credType = credTypeSelect.value;
            const studentName = generateRandomName();
            const date = generateRandomDate();
            const studentID = generateStudentID();
            const honor = getRandomElement(honors);
            const style = styleSelect.value;

            // Show/hide style selector
            styleGroup.style.display = credType === 'diploma' ? 'block' : 'none';

            if (credType === 'diploma') {
                credentialPreview.innerHTML = generateDiplomaHTML(studentName, date, honor, style);
            } else if (credType === 'tor') {
                credentialPreview.innerHTML = generateTORHTML(studentName, studentID, date);
            } else if (credType === 'certificate') {
                credentialPreview.innerHTML = generateCertificateHTML(studentName, date);
            }
        }

        // Event listeners
        credTypeSelect.addEventListener('change', updatePreview);
        styleSelect.addEventListener('change', updatePreview);
        degreeSelect.addEventListener('change', updatePreview);
        majorInput.addEventListener('input', updatePreview);
        institutionInput.addEventListener('input', updatePreview);

        // Generate credentials
        async function generateCredentials() {
            const count = parseInt(countInput.value);
            if (count < 1 || count > 50) {
                alert('Please enter a number between 1 and 50');
                return;
            }

            const credType = credTypeSelect.value;
            generateBtn.disabled = true;
            progress.classList.add('active');

            const { jsPDF } = window.jspdf;

            for (let i = 0; i < count; i++) {
                progressText.textContent = `Generating ${i + 1} of ${count}...`;
                progressFill.style.width = ((i / count) * 100) + '%';

                const studentName = generateRandomName();
                const date = generateRandomDate();
                const studentID = generateStudentID();
                const honor = getRandomElement(honors);
                const style = styleSelect.value;

                // Update preview with current credential
                if (credType === 'diploma') {
                    credentialPreview.innerHTML = generateDiplomaHTML(studentName, date, honor, style);
                } else if (credType === 'tor') {
                    credentialPreview.innerHTML = generateTORHTML(studentName, studentID, date);
                } else if (credType === 'certificate') {
                    credentialPreview.innerHTML = generateCertificateHTML(studentName, date);
                }

                await new Promise(resolve => setTimeout(resolve, 100));

                const credential = credentialPreview.querySelector('.credential');
                
                if (credType === 'tor') {
                    // Handle TOR with multiple pages
                    const pages = credential.querySelectorAll('.tor-page');
                    const pdf = new jsPDF({
                        orientation: 'portrait',
                        unit: 'mm',
                        format: [215.9, 330.2] // Long bond paper
                    });

                    for (let pageIdx = 0; pageIdx < pages.length; pageIdx++) {
                        const canvas = await html2canvas(pages[pageIdx], {
                            scale: 1.5, // <-- MODIFIED: Reduced scale from 2 to 1.5
                            backgroundColor: '#ffffff',
                            logging: false,
                            windowWidth: 816,  // 215.9mm * 3.78 (pixels per mm at 96 DPI)
                            windowHeight: 1248 // 330.2mm * 3.78
                        });

                        // <-- MODIFIED: Changed from 'image/png' to 'image/jpeg' with 80% quality
                        const imgData = canvas.toDataURL('image/jpeg', 0.8);
                        const pdfWidth = pdf.internal.pageSize.getWidth();
                        const pdfHeight = pdf.internal.pageSize.getHeight();

                        if (pageIdx > 0) {
                            pdf.addPage();
                        }
                        // <-- MODIFIED: Changed format from 'PNG' to 'JPEG'
                        pdf.addImage(imgData, 'JPEG', 0, 0, pdfWidth, pdfHeight);
                    }

                    const fileName = `sample_${credType}_${studentName.replace(/ /g, '_')}_${i + 1}.pdf`;
                    pdf.save(fileName);
                } else {
                    // Handle single page credentials (diploma, certificate)
                    const canvas = await html2canvas(credential, {
                        scale: 1.5,
                        backgroundColor: '#ffffff',
                        logging: false
                    });

                    const pdf = new jsPDF({
                        orientation: 'landscape',
                        unit: 'mm',
                        format: 'a4'
                    });

                    const imgData = canvas.toDataURL('image/jpeg', 0.8);
                    const pdfWidth = pdf.internal.pageSize.getWidth();
                    const pdfHeight = pdf.internal.pageSize.getHeight();

                    pdf.addImage(imgData, 'JPEG', 0, 0, pdfWidth, pdfHeight);
                    
                    const fileName = `sample_${credType}_${studentName.replace(/ /g, '_')}_${i + 1}.pdf`;
                    pdf.save(fileName);
                }

                await new Promise(resolve => setTimeout(resolve, 500));
            }

            progressText.textContent = `Complete! Generated ${count} credentials.`;
            progressFill.style.width = '100%';
            generateBtn.disabled = false;

            setTimeout(() => {
                progress.classList.remove('active');
            }, 2000);
        }

        // Initialize
        updatePreview();
    </script>
</body>
</html>